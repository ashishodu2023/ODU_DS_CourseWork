---
title: "Assignment-7"
author: "Ashish Verma"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{R}
library(BSDA)
library(asbio)
library(pwr)
```
## Section 8.4 Problem #44
### Solution(a):
```{R}
# Given data
n <- 100        # Sample size
x <- 14         # Number of plates that blistered
p_0 <- 0.10     # Hypothesized proportion
alpha<-0.05

p_value<-prop.test(x=x,n=n,p=p_0,alternative = "greater",conf.level = 1 - alpha,correct = FALSE)$p.value

# Check if the null hypothesis is rejected
if (p_value < alpha) {
cat("Reject the null hypothesis. There is evidence that more than 10% blister under such circumstances.\n")
} else {
 cat("Fail to reject the null hypothesis. There is not enough evidence to conclude that more than 10% blister under such circumstances.\n")
}
```
The possible error that could have made is a Type-II error. Fail to reject the null hypothesis when it is actually false.

### Solution(b):
```{R}

# Given data
p_prime <- 0.15   # True proportion of blistered plates
alpha <- 0.05     # Significance level
n1 <- 100
p0 <- 0.10
beta_15_100 <- pnorm((p0-p_prime+qnorm(0.95)*sqrt(p0*(1-p0)/n1))/sqrt(p_prime*(1-p_prime)/n1))


# Sample size of 200
n2 <- 200
beta_15_200<-pnorm((p0-p_prime+qnorm(0.95)*sqrt(p0*(1-p0)/n2))/sqrt(p_prime*(1-p_prime)/n2))

# Print the results
cat("Type II Error (beta) for n = 100: of all the samples will result in correct rejection of p0\n", beta_15_100, "\n")
cat("Type II Error (beta) for n = 200: of all the samples will result in correct rejection of p0\n", beta_15_200, "\n")

```
### Solution(c)
```{R}
# Given data
p_prime <- 0.15   # True proportion of blistered plates
alpha <- 0.05    # Significance level
beta <-0.1
p0<-0.1

number_of_sample<-((qnorm(1 - alpha)*sqrt(p0*(1 -p0))+qnorm(1 - beta)*sqrt(p_prime*(1 -p_prime)))/(p_prime -p0))^2
cat("The number of sample size required",ceiling(number_of_sample))
```
## Section 8.4 Problem #50

### Solution(a):
The probability of type 1 error for the chosen region is
P(Type 1 error) =P(Reject H0 when it is true)
```{R}
X <- 14
n <- 20
p0 <- 0.5
alpha <- 0.05
result<- 1 - pbinom(X, n, p0)
cat("It is not achievable and the value of alpha is.",result)
```
### Solution(b):
```{R}
p0<-0.5
n<-20
alpha<-0.0207
p_prime<-0.6
p_prime_1<-0.8
beta_06<-pbinom(14, n, p_prime)
cat("The beta(0.6) is given as",beta_06)

beta_08<-pbinom(14, n, p_prime_1)
cat("The beta(0.8) is given as",beta_08)
```
### Solution(c):
If  13 out of the 20  people prefer gut , should H0 be rejected using a significance level of 0.1
```{R}
X1 =13
X2 =14 ##Assuming.
alpha_1<- 1 - pbinom(X1, 20, 0.5)
alpha_2<- 1 - pbinom(X2, 20, 0.5)
cat("Since alpha_1 > alpha_2, failed to reject H0",alpha_1,alpha_2)
```
Since 13<14 thus, failed to reject H0

## Section 9.1 Problem #6
### Solution(a)
```{R}
xbar<-18.12
ybar<-16.87
m<-40
n<-32
sigma1<-1.6
sigma2<-1.4
alpha<-0.01
result<-z.test(x=rep(18.12,times=40),y=rep(16.87,times=32),alternative = "greater",sigma.x = sigma1,sigma.y = sigma2,conf.level = 1 -alpha)
if (result$p.value<alpha){
  cat("Reject the null hypothesis")
}else{
  cat("Failed to reject the null hypothesis")
}
```
### Solution(b)
```{R}
beta_1<-pnorm(qnorm(1 -alpha) - ((1-0)/sqrt(((sigma1^2)/m)+((sigma2^2)/n))))
cat("The type 2 error for beta(1)\n",beta_1)
```
### Solution(c)
```{R}
alpha_new<-0.05
beta_new<-0.1
m<-40
sigma1<-1.6
sigma2<-1.4
numerator <- sigma2^2
denominator1 <- 1/(qnorm(1 - alpha_new)+qnorm(1 - beta_new))^2
denominator2<- sigma1^2/m
n<-numerator/(denominator1 -denominator2)
cat("The number of sample of N required are\n",ceiling(n))
```
### Solution(d)
```{R}
s1 <- 1.6  
s2 <- 1.4  
n1 <- 40   
n2 <- 32   
delta <- 0 
xbar<-18.12
ybar<-16.87
alpha<-0.01
df <- ((s1^2 / n1) + (s2^2 / n2))^2 / (((s1^2 / n1)^2 / (n1 - 1)) + ((s2^2 / n2)^2 / (n2 - 1)))
t_stat <- ((xbar - ybar) - delta) / sqrt((s1^2 / n1) + (s2^2 / n2))
p_value <- pt(t_stat, df = df, lower.tail = FALSE)
if (p_value<alpha){
  cat("Reject the null hypothesis.")
}else{
  cat("Failed to reject the null hypothesis")
}
```

## Section 9.1 Problem #8
### Solution(a)
```{R}
xbar<-107.6
ybar<-123.6
m<-129
n<-129
s1<-1.3
s2<-2.0
alpha<-0.01
mu_dff<--10
z_result<- (xbar-ybar)-(-mu_dff)/sqrt(((s1^2)/m)+((s2^2)/n))
p_value<-pnorm(z_result)
if (p_value<alpha){
  cat("Reject the null hypothesis.The true average strength for the 1078 grade exceeds that for the 1064 grade by more than 10kg/mm2.")
}else{
  cat("Failed to reject the null hypothesis")
}
```
### Solution(b)
```{R}
margin_of_error<-sqrt(((s1^2)/m)+((s2^2)/n))*qnorm(1 - alpha/2)
c_lower<-(xbar-ybar)-margin_of_error
c_upper<-(xbar-ybar)+margin_of_error
cat("The 95% confidence interval for the difference between the true average strengths for the two grades is approximately\n",abs(c_lower),abs(c_upper))
```

## Part 2
### Solution:
```{R}
# Given data
n <- 40
sample_mean <- 825
sample_sd <- 48.5
population_sd_hypothesized <- 40
alpha <- 0.05

# Test statistic calculation for both tests
test_statistic_a <- ((n - 1) * (sample_sd)^2) / (population_sd_hypothesized)^2
test_statistic_b <- ((n - 1) * (sample_sd)^2) / (population_sd_hypothesized)^2

# Degrees of freedom
df <- n - 1

# Critical values for chi-square distribution
critical_value_a <- qchisq(1 - alpha, df)
critical_value_b_lower <- qchisq(alpha / 2, df)
critical_value_b_upper <- qchisq(1 - alpha / 2, df)

# Output
cat("Test Statistic (a):", test_statistic_a, "\n")
cat("Critical Value (a):", critical_value_a, "\n")
cat("Test Statistic (b):", test_statistic_b, "\n")
cat("Critical Values (b):", critical_value_b_lower, "and", critical_value_b_upper, "\n")

# Conclusion for test (a)
if (test_statistic_a < critical_value_a) {
  cat("Since the test statistic is less than the critical value, we fail to reject the null hypothesis for test (a).","\n")
} else {
  cat("Since the test statistic is greater than the critical value, we reject the null hypothesis for test (a).","\n")
}

# Conclusion for test (b)
if (test_statistic_b < critical_value_b_lower || test_statistic_b > critical_value_b_upper) {
  cat("Since the test statistic falls outside the critical region, we reject the null hypothesis for test (b).","\n")
} else {
  cat("Since the test statistic falls inside the critical region, we fail to reject the null hypothesis for test (b).","\n")
}

```
